<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marleen Molenaar Wholesale Collection</title>
    <meta name="description" content="Professional wholesale catalogue for Marleen Molenaar premium sleepwear collection.">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f8f9fa;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem 0;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }
        
        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 1rem;
        }
        
        .totals {
            font-size: 1.1rem;
            font-weight: 600;
            background: rgba(255,255,255,0.2);
            padding: 0.8rem 1.5rem;
            border-radius: 25px;
            display: inline-block;
            backdrop-filter: blur(10px);
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .filters {
            background: white;
            padding: 1.5rem;
            margin: 2rem 0;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .filter-row {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            align-items: center;
        }
        
        .filter-group {
            display: flex;
            flex-direction: column;
            min-width: 150px;
        }
        
        .filter-group label {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #555;
        }
        
        .filter-group select, .filter-group input {
            padding: 0.5rem;
            border: 2px solid #e9ecef;
            border-radius: 5px;
            font-size: 1rem;
        }
        
        .filter-group select:focus, .filter-group input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
            margin: 2rem 0;
        }
        
        @media (min-width: 768px) {
            .grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (min-width: 1024px) {
            .grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        .product-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 3px 12px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .product-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }
        
        .product-image {
            width: 100%;
            height: 250px;
            overflow: hidden;
            background: #f8f9fa;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        .product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }
        
        .product-card:hover .product-image img {
            transform: scale(1.05);
        }
        
        .placeholder {
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #f0f0f0, #e0e0e0);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
            font-size: 0.9rem;
            text-align: center;
        }
        
        .product-info {
            padding: 1.2rem;
        }
        
        .product-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #2c3e50;
            line-height: 1.3;
        }
        
        .product-details {
            display: grid;
            grid-template-columns: 1fr;
            gap: 0.3rem;
            margin: 0.8rem 0;
            font-size: 0.85rem;
            color: #666;
        }
        
        .product-prices {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #e9ecef;
        }
        
        .anchor-price {
            text-decoration: line-through;
            color: #999;
            font-size: 0.9rem;
        }
        
        .wholesale-price {
            font-size: 1.3rem;
            font-weight: 700;
            color: #28a745;
        }
        
        .discount-badge {
            background: #dc3545;
            color: white;
            padding: 0.25rem 0.7rem;
            border-radius: 15px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .category-badge {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.75rem;
            margin-bottom: 0.5rem;
        }
        
        .contact-section {
            background: white;
            padding: 2rem;
            margin: 3rem 0;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .contact-section h2 {
            color: #2c3e50;
            margin-bottom: 1rem;
        }
        
        .contact-info {
            font-size: 1.1rem;
            color: #666;
            line-height: 1.8;
        }
        
        .contact-highlight {
            background: #667eea;
            color: white;
            padding: 1.5rem;
            border-radius: 10px;
            margin: 1rem 0;
            font-weight: 600;
        }
        
        .visible-count {
            text-align: center;
            margin: 1rem 0;
            font-weight: 600;
            color: #667eea;
        }
        
        .error-log {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 5px;
            font-size: 0.9rem;
        }
        
        .download-link {
            color: #667eea;
            text-decoration: none;
            font-weight: 600;
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .filter-row {
                flex-direction: column;
                align-items: stretch;
            }
            
            .product-image {
                height: 200px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="container">
            <h1>Marleen Molenaar Collection</h1>
            <p>Premium Children's & Ladies Sleepwear - Wholesale Catalogue</p>
            <div class="totals">
                <span id="total-pieces">168</span> pieces · 
                <span id="total-skus">168</span> SKUs · 
                50 boxes
            </div>
        </div>
    </div>
    
    <div class="container">
        <div class="filters">
            <div class="filter-row">
                <div class="filter-group">
                    <label for="brandFilter">Brand</label>
                    <select id="brandFilter">
                        <option value="">All Brands</option>
                        <option value="Marleen Molenaar">Marleen Molenaar</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label for="categoryFilter">Category</label>
                    <select id="categoryFilter">
                        <option value="">All Categories</option>
                        <option value="Children's Clothing">Children's Clothing</option>
<option value="Ladies Clothing">Ladies Clothing</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label for="sizeFilter">Size</label>
                    <select id="sizeFilter">
                        <option value="">All Sizes</option>
                        <option value="10">10</option>
<option value="10, 12">10, 12</option>
<option value="12">12</option>
<option value="2">2</option>
<option value="2, 10">2, 10</option>
<option value="2, 10, 12">2, 10, 12</option>
<option value="2, 12">2, 12</option>
<option value="2, 4">2, 4</option>
<option value="2, 4, 10, 12">2, 4, 10, 12</option>
<option value="2, 4, 12">2, 4, 12</option>
<option value="2, 4, 6">2, 4, 6</option>
<option value="2, 4, 6, 10, 12">2, 4, 6, 10, 12</option>
<option value="2, 4, 6, 12">2, 4, 6, 12</option>
<option value="2, 4, 6, 8">2, 4, 6, 8</option>
<option value="2, 4, 6, 8, 10">2, 4, 6, 8, 10</option>
<option value="2, 4, 6, 8, 10, 12">2, 4, 6, 8, 10, 12</option>
<option value="2, 4, 8, 10, 12">2, 4, 8, 10, 12</option>
<option value="2, 4, 8, 12">2, 4, 8, 12</option>
<option value="2, 6">2, 6</option>
<option value="2, 6, 12">2, 6, 12</option>
<option value="2, 6, 8">2, 6, 8</option>
<option value="2, 6, 8, 10, 12">2, 6, 8, 10, 12</option>
<option value="2, 8">2, 8</option>
<option value="2, 8, 10">2, 8, 10</option>
<option value="2, 8, 10, 12">2, 8, 10, 12</option>
<option value="4">4</option>
<option value="4, 10">4, 10</option>
<option value="4, 10, 12">4, 10, 12</option>
<option value="4, 12">4, 12</option>
<option value="4, 6">4, 6</option>
<option value="4, 6, 10, 12">4, 6, 10, 12</option>
<option value="4, 6, 12">4, 6, 12</option>
<option value="4, 6, 8">4, 6, 8</option>
<option value="6">6</option>
<option value="6, 10">6, 10</option>
<option value="6, 14">6, 14</option>
<option value="6, 8">6, 8</option>
<option value="6, 8, 10, 12">6, 8, 10, 12</option>
<option value="8">8</option>
<option value="8, 10">8, 10</option>
<option value="Various">Various</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label for="conditionFilter">Condition</label>
                    <select id="conditionFilter">
                        <option value="">All Conditions</option>
                        <option value="New with Tags">New with Tags</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label for="searchFilter">Search</label>
                    <input type="text" id="searchFilter" placeholder="Search items...">
                </div>
            </div>
        </div>
        
        <div class="visible-count">
            Showing <span id="visible-count">168</span> items
        </div>
        
        <div class="grid" id="productGrid">
            <!-- Products will be loaded here by JavaScript -->
        </div>
        
        <div class="contact-section">
            <h2>Wholesale Inquiries</h2>
            <div class="contact-highlight">
                <p><strong>Gary Flax</strong></p>
                <p><strong>Mobile:</strong> +61 414 242 142</p>
            </div>
            <div class="contact-info">
                <p><strong>Location:</strong> Vaucluse, Sydney NSW</p>
                <p><strong>Viewing:</strong> Weekdays 5pm+, Weekends anytime</p>
                <p><strong>Collection:</strong> <span id="footer-total-pieces">168</span> pieces in <span id="footer-total-skus">168</span> SKUs</p>
                <p><strong>Storage:</strong> Professional organization in 50 containers</p>
                <p><strong>Brand:</strong> Marleen Molenaar (Lane Crawford Heritage)</p>
                <p><strong>Wholesale Price:</strong> $18,000-22,000 complete collection</p>
                <p><strong>Quick Sale:</strong> $12,000-15,000 complete collection</p>
                <p><strong>Access:</strong> Ground floor, driveway access for easy pickup</p>
            </div>
        </div>
        
        
    </div>
    
    <script>
        const skuImageMapping = {};
        
        // Auto-generate SKU to image mapping
        function generateImageMapping() {
            for (let i = 1; i <= 33; i++) {
                const sku = `MM_${i.toString().padStart(4, '0')}`;
                skuImageMapping[sku] = `images/image${i}_small.jpg`;
            }
        }
        
        generateImageMapping();

        // Error log for download
        const errorLog = `No errors encountered during processing.`;
        
        function downloadErrors() {
            const blob = new Blob([errorLog], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'CSV_Errors.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }
        
        // Load and render products
        async function loadProducts() {
            try {
                const response = await fetch('detailed_inventory.csv');
                const csvText = await response.text();
                const lines = csvText.split('\n');
                const headers = lines[0].split(',');
                
                const products = [];
                let totalPieces = 0;
                let totalSKUs = 0;
                
                for (let i = 1; i < lines.length; i++) {
                    if (lines[i].trim()) {
                        const row = lines[i].split(',');
                        const product = {};
                        
                        headers.forEach((header, index) => {
                            product[header.trim()] = row[index] ? row[index].trim() : '';
                        });
                        
                        const qty = parseInt(product.Qty) || 0;
                        if (qty > 0) {
                            products.push(product);
                            totalPieces += qty;
                            totalSKUs += 1;
                        }
                    }
                }
                
                // Update totals
                document.getElementById('total-pieces').textContent = totalPieces;
                document.getElementById('total-skus').textContent = totalSKUs;
                document.getElementById('footer-total-pieces').textContent = totalPieces;
                document.getElementById('footer-total-skus').textContent = totalSKUs;
                
                renderProducts(products);
                
            } catch (error) {
                console.error('Error loading products:', error);
                document.getElementById('productGrid').innerHTML = '<p>Error loading products. Please check the CSV file.</p>';
            }
        }
        
        function renderProducts(products) {
            const grid = document.getElementById('productGrid');
            grid.innerHTML = '';
            
            products.forEach(product => {
                const discount = product.Anchor_Price_AUD > 0 ? 
                    Math.round(((product.Anchor_Price_AUD - product.Wholesale_Price_AUD) / product.Anchor_Price_AUD) * 100) : 0;
                
                // Determine image source
                const sku = product.SKU;
                let imageSrc = skuImageMapping[sku] || 'images/placeholder.webp';
                let imageAlt = `${product.Brand} - ${product.Item_Name}`;
                
                const card = document.createElement('div');
                card.className = 'product-card';
                card.dataset.brand = product.Brand.toLowerCase();
                card.dataset.category = product.Category.toLowerCase();
                card.dataset.size = product.Size.toLowerCase();
                card.dataset.condition = product.Condition.toLowerCase();
                card.dataset.search = `${product.Brand} ${product.Item_Name} ${product.Size} ${product.Colour}`.toLowerCase();
                
                card.innerHTML = `
                    <div class="product-image">
                        <img src="${imageSrc}" alt="${imageAlt}" 
                             onerror="this.parentElement.innerHTML='<div class=\"placeholder\">Photo<br>Coming Soon</div>'; console.log('Missing image for SKU: ${sku}');">
                    </div>
                    <div class="product-info">
                        <div class="category-badge">${product.Category}</div>
                        <div class="product-title">${product.Item_Name}</div>
                        <div class="product-details">
                            <div><strong>SKU:</strong> ${product.SKU}</div>
                            <div><strong>Brand:</strong> ${product.Brand}</div>
                            <div><strong>Size:</strong> ${product.Size}</div>
                            <div><strong>Colour:</strong> ${product.Colour}</div>
                            <div><strong>Condition:</strong> ${product.Condition}</div>
                            <div><strong>Qty:</strong> ${product.Qty}</div>
                        </div>
                        <div class="product-prices">
                            <div>
                                <div class="anchor-price">RRP $$${parseFloat(product.Anchor_Price_AUD).toFixed(2)}</div>
                                <div class="wholesale-price">$$${parseFloat(product.Wholesale_Price_AUD).toFixed(2)}</div>
                            </div>
                            <div class="discount-badge">${discount}% OFF</div>
                        </div>
                    </div>
                `;
                
                grid.appendChild(card);
            });
            
            updateVisibleCount();
        }
        
        // Filter functionality
        function filterProducts() {
            const brandFilter = document.getElementById('brandFilter').value.toLowerCase();
            const categoryFilter = document.getElementById('categoryFilter').value.toLowerCase();
            const sizeFilter = document.getElementById('sizeFilter').value.toLowerCase();
            const conditionFilter = document.getElementById('conditionFilter').value.toLowerCase();
            const searchFilter = document.getElementById('searchFilter').value.toLowerCase();
            
            const cards = document.querySelectorAll('.product-card');
            let visibleCount = 0;
            
            cards.forEach(card => {
                const brand = card.dataset.brand;
                const category = card.dataset.category;
                const size = card.dataset.size;
                const condition = card.dataset.condition;
                const search = card.dataset.search;
                
                const brandMatch = !brandFilter || brand.includes(brandFilter);
                const categoryMatch = !categoryFilter || category.includes(categoryFilter);
                const sizeMatch = !sizeFilter || size.includes(sizeFilter);
                const conditionMatch = !conditionFilter || condition.includes(conditionFilter);
                const searchMatch = !searchFilter || search.includes(searchFilter);
                
                if (brandMatch && categoryMatch && sizeMatch && conditionMatch && searchMatch) {
                    card.style.display = 'block';
                    visibleCount++;
                } else {
                    card.style.display = 'none';
                }
            });
            
            document.getElementById('visible-count').textContent = visibleCount;
        }
        
        function updateVisibleCount() {
            const visibleCards = document.querySelectorAll('.product-card[style*="display: block"], .product-card:not([style*="display: none"])');
            document.getElementById('visible-count').textContent = visibleCards.length;
        }
        
        // Event listeners
        document.getElementById('brandFilter').addEventListener('change', filterProducts);
        document.getElementById('categoryFilter').addEventListener('change', filterProducts);
        document.getElementById('sizeFilter').addEventListener('change', filterProducts);
        document.getElementById('conditionFilter').addEventListener('change', filterProducts);
        document.getElementById('searchFilter').addEventListener('input', filterProducts);
        
        // Initialize
        loadProducts();
    

    // Load metrics from summary_metrics.json
    fetch('summary_metrics.json')
      .then(r => r.json())
      .then(m => {
        console.log('Loaded metrics:', m);
        
        const s = id => document.getElementById(id);
        
        // Update header totals
        if (document.querySelector('.totals')) {
          document.querySelector('.totals').textContent =
            `${(m.TOTAL_UNITS||0).toLocaleString()} pieces • ${(m.TOTAL_SKUS||0).toLocaleString()} SKUs • 50 boxes`;
        }
        
        // Update footer totals
        const footerTotals = document.querySelector('.footer-stats');
        if (footerTotals) {
            footerTotals.innerHTML = `
                <p><strong>${(m.TOTAL_UNITS||0).toLocaleString()}</strong> pieces across <strong>${(m.TOTAL_SKUS||0).toLocaleString()}</strong> SKUs</p>
                <p>Organized in <strong>50</strong> boxes for easy pickup</p>
            `;
        }
        
        // Update any other total displays
        if (s('total-pieces')) s('total-pieces').textContent = (m.TOTAL_UNITS||0).toLocaleString();
        if (s('total-skus')) s('total-skus').textContent = (m.TOTAL_SKUS||0).toLocaleString();
        if (s('footer-total-pieces')) s('footer-total-pieces').textContent = (m.TOTAL_UNITS||0).toLocaleString();
        if (s('footer-total-skus')) s('footer-total-skus').textContent = (m.TOTAL_SKUS||0).toLocaleString();
        
      })
      .catch(err => {
        console.error('Failed to load metrics:', err);
        // Fallback to calculating from visible products
        const visibleCards = document.querySelectorAll('.product-card');
        let totalUnits = 0;
        visibleCards.forEach(card => {
          const qtyText = card.querySelector('.qty')?.textContent || '1';
          const qty = parseInt(qtyText.replace(/[^0-9]/g, '')) || 1;
          totalUnits += qty;
        });
        
        if (document.querySelector('.totals')) {
          document.querySelector('.totals').textContent =
            `${totalUnits.toLocaleString()} pieces • ${visibleCards.length.toLocaleString()} SKUs • 50 boxes`;
        }
      });
</script>
</body>
</html>