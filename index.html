<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Marleen Molenaar Collection ‚Äî Wholesale Catalogue</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#f6f7fb; --card:#ffffff; --ink:#0e1025; --ink2:#4b4f69; --border:#e7e8f1; --chip:#eef0fb;
  --brand1:#6f4cf6; --brand2:#9b66ff; --foot:#0f1129; --footCard:#161b33; --shadow:0 10px 26px rgba(25,26,54,.08);
}
body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.55 Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
a{color:#4e5bff;text-decoration:none;font-weight:600}
.header{padding:56px 20px 110px;background:linear-gradient(135deg,var(--brand1),var(--brand2));color:#fff}
.wrap{max-width:1160px;margin:0 auto}
.h1{font-size:clamp(34px,5vw,64px);font-weight:800;margin:0 0 10px}
.tag{display:inline-block;margin-top:16px;padding:10px 16px;border-radius:999px;background:rgba(255,255,255,.16);font-weight:700}
.panel{margin-top:-70px}
.card{background:#fff;border:1px solid var(--border);border-radius:18px;padding:18px;box-shadow:var(--shadow);margin:16px 0}
.grid7{display:grid;grid-template-columns:repeat(7,1fr);gap:12px}
@media(max-width:980px){.grid7{grid-template-columns:repeat(3,1fr)}}
@media(max-width:620px){.grid7{grid-template-columns:repeat(2,1fr)}}
.sizepill{background:#fff;border:1px solid var(--border);border-radius:16px;padding:12px;text-align:center}
.sizepill b{display:block;font-size:18px;margin-bottom:4px}
.kvgrid{display:grid;grid-template-columns:repeat(3,1fr);gap:14px}
@media(max-width:980px){.kvgrid{grid-template-columns:1fr}}
.kv{padding:16px;border:1px solid var(--border);border-radius:16px;background:#fff}
.controls{display:flex;gap:10px;flex-wrap:wrap;margin:10px 0}
select,input{height:40px;padding:0 12px;border:1px solid var(--border);border-radius:12px}
.gridCards{display:grid;grid-template-columns:repeat(3,1fr);gap:18px}
@media(max-width:980px){.gridCards{grid-template-columns:repeat(2,1fr)}}
@media(max-width:650px){.gridCards{grid-template-columns:1fr}}
.item{background:#fff;border:1px solid var(--border);border-radius:20px;overflow:hidden;box-shadow:var(--shadow)}
.pic{background:#f4f5fa;height:260px;display:flex;align-items:center;justify-content:center}
.pic img{max-width:95%;max-height:95%;object-fit:contain}
.meta{padding:16px 18px}
.meta h3{margin:0 0 4px;font-size:20px}
.sub{color:var(--ink2);font-size:14px;margin-bottom:10px}
.chips{display:flex;gap:6px;flex-wrap:wrap}
.chip{background:var(--chip);border:1px dashed var(--border);padding:5px 10px;border-radius:999px;font-size:12px;font-weight:600}
.row{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
.badge{background:#f6f7fb;border:1px solid var(--border);border-radius:999px;padding:6px 12px;font-weight:600}
.footer{background:var(--foot);color:#eaf0ff;margin-top:28px}
.footer .wrap{display:grid;grid-template-columns:1.2fr .8fr;gap:18px;padding:26px 20px}
@media(max-width:820px){.footer .wrap{grid-template-columns:1fr}}
.footCard{background:var(--footCard);border-radius:18px;padding:18px 20px}
.footCard h3{color:#aeb8ff;margin:0 0 10px}
.stat{margin-top:8px;background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.12);border-radius:14px;padding:14px}
.stat small{color:#9fb3ff;display:block;margin-bottom:4px;font-weight:600}
.stat b{font-size:20px}
</style>
</head>
<body>
<header class="header">
  <div class="wrap">
    <h1 class="h1">Marleen Molenaar Collection</h1>
    <div id="heroPill" class="tag">Loading‚Ä¶</div>
  </div>
</header>

<main class="wrap panel">
  <section class="card">
    <h2>üßµ Size Breakdown ‚Äî Pieces Available</h2>
    <div id="sizes" class="grid7"></div>
  </section>

  <section class="kvgrid">
    <div class="kv">
      <h4>üèÜ Lane Crawford Luxury Retailer</h4>
      <a href="https://www.lanecrawford.com/brand/700351/marleen-molenaar-sleepwear/women">View Brand Page</a>
    </div>
    <div class="kv">
      <h4>üí∞ Retail Pricing Evidence</h4>
      <a href="https://www.retykle.com/search?q=marleen%20molenaar">Retykle Pricing Proof</a>
    </div>
    <div class="kv">
      <h4>üì∞ Media Coverage</h4>
      <a href="https://www.scmp.com/article/533820/eastern-premise">South China Morning Post</a>
    </div>
  </section>

  <section class="card">
    <div class="controls">
      <select id="sizeFilter"><option value="">All Sizes</option><option>2</option><option>4</option><option>6</option><option>8</option><option>10</option><option>12</option><option>14</option></select>
      <select id="catFilter"><option value="">All Categories</option><option>Children's</option><option>Ladies</option><option>Boys</option><option>Baby</option><option>Unisex</option></select>
      <input id="search" type="search" placeholder="Search name, colour, description"/>
    </div>
    <div id="grid" class="gridCards"></div>
    <div id="empty" class="empty" style="display:none">No results.</div>
  </section>
</main>

<footer class="footer">
  <div class="wrap">
    <div class="footCard">
      <h3>Contact Information</h3>
      <p><strong>Gary Flax:</strong> +61 414 242 142<br>Vaucluse, Sydney NSW<br>Viewing: Weekdays 5pm+, Weekends anytime</p>
      <div class="stat"><small>Wholesale (target)</small><b id="sumWholesaleFooter">‚Äî</b></div>
      <div class="stat"><small>Quick sale (target)</small><b id="sumQuickFooter">‚Äî</b></div>
    </div>
    <div class="footCard">
      <h3>Collection Summary</h3>
      <p><span id="sumPieces">‚Äî</span> pieces across <span id="sumSkus">‚Äî</span> SKUs</p>
    </div>
  </div>
</footer>

<script>
const INV_URL='detailed_inventory.csv';
const MAP_URL='image_map.csv';
const PLACEHOLDER='images/placeholder.webp';
const WHOLESALE_FACTOR=0.40, QUICK_SALE_TARGET=12000;

const lc=s=> (s||'').toString().trim().toLowerCase();
const num=v=> Number((v??'').toString().replace(/[^\d.\-]/g,''))||0;
const money=v=> new Intl.NumberFormat('en-AU',{style:'currency',currency:'AUD'}).format(v||0);
const fmt=v=> (+v||0).toLocaleString('en-AU');

function splitCSVLine(s){const out=[];let cur="";let q=false;for(let i=0;i<s.length;i++){const c=s[i];if(c=='"'){if(q&&s[i+1]=='"'){cur+='"';i++;}else{q=!q;}}else if(c==","&&!q){out.push(cur);cur="";}else cur+=c;}out.push(cur);return out;}
function parseCSV(txt){const lines=txt.replace(/\r/g,"").split("\n").filter(l=>l.trim());const head=splitCSVLine(lines.shift());return lines.map(l=>{const c=splitCSVLine(l);const o={};head.forEach((h,i)=>o[h]=c[i]||"");return o;});}
async function fetchCSV(url){const r=await fetch(url);return parseCSV(await r.text());}
async function fetchJSON(url){const r=await fetch(url);return await r.json();}

function normalise(r){return{
  item_name:r.item_name||r.name, description:r.description, category:r.category, subcategory:r.subcategory,
  colour:r.colour, rrp:num(r.rrp),
  size2:num(r.size2),size4:num(r.size4),size6:num(r.size6),size8:num(r.size8),size10:num(r.size10),size12:num(r.size12),size14:num(r.size14),
  qty:num(r.total_qty)|| (num(r.size2)+num(r.size4)+num(r.size6)+num(r.size8)+num(r.size10)+num(r.size12)+num(r.size14))
};}

function aggregate(rows){const map=new Map();for(const r of rows){const k=[lc(r.item_name),lc(r.colour||''),lc(r.subcategory||'')].join('|');if(!map.has(k))map.set(k,{...r});else{const g=map.get(k);['size2','size4','size6','size8','size10','size12','size14','qty'].forEach(f=>g[f]+=r[f]);}}return [...map.values()];}

let IMG_INDEX=new Map();
function buildImageIndex(rows){rows.forEach(r=>{if(r.image&&r.name){IMG_INDEX.set(lc(r.name),r.image);}});}
function pickImage(n){return IMG_INDEX.get(lc(n))||PLACEHOLDER;}

function sizeChips(r){const out=[];[[2,'size2'],[4,'size4'],[6,'size6'],[8,'size8'],[10,'size10'],[12,'size12'],[14,'size14']].forEach(([n,f])=>{if(r[f]>0)out.push(`<span class="chip"><b>Size ${n}</b> (${r[f]} pcs)</span>`);});return out.join('');}

function renderMetrics(rows){const pcs=rows.reduce((a,b)=>a+b.qty,0),skus=rows.length;document.getElementById('heroPill').textContent=`${fmt(pcs)} pieces ‚Ä¢ ${fmt(skus)} SKUs`;document.getElementById('sumPieces').textContent=fmt(pcs);document.getElementById('sumSkus').textContent=fmt(skus);
const t={2:0,4:0,6:0,8:0,10:0,12:0,14:0};rows.forEach(r=>{for(const k in t){t[k]+=r['size'+k];}});document.getElementById('sizes').innerHTML=Object.keys(t).map(s=>`<div class="sizepill"><b>Size ${s}</b><span class="sub">${fmt(t[s])} pcs</span></div>`).join('');
const w=rows.reduce((a,r)=>a+(r.rrp*WHOLESALE_FACTOR)*r.qty,0);document.getElementById('sumWholesaleFooter').textContent=money(w);document.getElementById('sumQuickFooter').textContent=money(QUICK_SALE_TARGET);}

function renderList(rows){const size=document.getElementById('sizeFilter').value,cat=document.getElementById('catFilter').value,q=document.getElementById('search').value.toLowerCase();
const f=rows.filter(r=>{if(size&&!(r['size'+size]>0))return false;if(cat&&r.category!==cat&&r.subcategory!==cat)return false;if(q&&!`${r.item_name} ${r.description} ${r.colour}`.toLowerCase().includes(q))return false;return true;});
const grid=document.getElementById('grid');grid.innerHTML=f.map(r=>`<article class="item"><div class="pic"><img src="${pickImage(r.item_name)}" alt="${r.item_name}"></div><div class="meta"><h3>${r.item_name}</h3><div class="sub">${[r.description,r.colour].filter(Boolean).join(' ‚Ä¢ ')}</div><div class="chips">${sizeChips(r)}</div><div class="row"><div class="badge"><strong>Qty:</strong>&nbsp;${fmt(r.qty)}</div><div class="badge"><strong>RRP:</strong>&nbsp;${money(r.rrp)}</div><div class="badge"><strong>Wholesale:</strong>&nbsp;${money(r.rrp*WHOLESALE_FACTOR)}</div></div></div></article>`).join('');
document.getElementById('empty').style.display=f.length?"none":"";}

async function start(){try{
  const [inv,map]=await Promise.all([fetchCSV(INV_URL),fetchCSV(MAP_URL)]);
  const inventory=aggregate(inv.map(normalise));buildImageIndex(map);
  renderMetrics(inventory);
  ['sizeFilter','catFilter','search'].forEach(id=>document.getElementById(id).addEventListener('input',()=>renderList(inventory)));
  renderList(inventory);
}catch(e){console.error(e);document.getElementById('grid').innerHTML='<div class="empty">Error loading files</div>';}}
start();
</script>
</body>
</html>
