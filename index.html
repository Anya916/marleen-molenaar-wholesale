<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Marleen Molenaar Collection ‚Äî Wholesale Catalogue</title>
<meta name="description" content="Premium children's & ladies' sleepwear wholesale catalogue ‚Äî Marleen Molenaar (all new with tags).">
<style>
  :root{ --purple1:#667eea; --purple2:#764ba2; --bg:#f6f5fb; --card:#fff; --ink:#1f1a33; --muted:#6f6486; --border:#e7e3f3 }
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;background:var(--bg);color:var(--ink)}
  .hero{background:linear-gradient(135deg,var(--purple1),var(--purple2));color:#fff;text-align:center;padding:44px 16px 36px}
  .hero h1{margin:0 0 8px;font-size:44px;line-height:1.1;font-weight:800}
  .hero p{margin:0 0 16px;opacity:.95}
  .pill{display:inline-block;padding:10px 18px;border-radius:999px;background:rgba(255,255,255,.18);border:1px solid rgba(255,255,255,.35);font-weight:700}

  .wrap{max-width:1200px;margin:0 auto;padding:0 16px}
  .panel{background:var(--card);border:1px solid var(--border);border-radius:14px;margin:18px 0;padding:16px;box-shadow:0 2px 10px rgba(0,0,0,.06)}
  .panel h3{margin:0 0 10px;color:#2a1a47}

  .size-tiles{display:grid;grid-template-columns:repeat(auto-fit,minmax(130px,1fr));gap:12px}
  .size-tile{background:#f4f0ff;border:1px solid var(--border);border-radius:12px;padding:14px;text-align:center}
  .size-tile b{display:block;font-size:22px;color:#2a1a47}
  .size-tile span{display:block;font-size:13px;color:var(--muted);margin-top:4px}

  .proof{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:14px}
  .proof-card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:14px}
  .proof-card h4{margin:0 0 6px;color:#2a1a47}
  .proof-card a{color:#1a5cff;text-decoration:none;font-weight:600}
  .proof-card p{margin:6px 0 0;color:#6d5e85;font-size:14px}

  .filters{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:16px;margin:18px 0}
  .row{display:flex;gap:10px;flex-wrap:wrap}
  .filters input,.filters select{padding:8px 10px;border:1px solid var(--border);border-radius:10px;background:#fff;min-width:200px}
  .filters .meta{margin-top:10px;color:var(--muted);font-size:14px;display:flex;justify-content:space-between;gap:10px;flex-wrap:wrap}

  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:14px;margin-bottom:28px}
  .card{background:#fff;border:1px solid var(--border);border-radius:12px;overflow:hidden;box-shadow:0 2px 10px rgba(0,0,0,.06)}
  .imgbox{height:180px;background:#fff;border-bottom:1px solid #eee;display:flex;align-items:center;justify-content:center;overflow:hidden}
  .imgbox img{max-width:100%;max-height:100%;object-fit:contain;width:auto;height:auto;background:#fff}
  .body{padding:12px}
  .title{font-weight:800;color:#2a1a47;margin:0 0 6px}
  .muted{color:#6d5e85;font-size:13px}
  .sizes{margin-top:6px}
  .sizes .chip{background:#f4f0ff;border:1px solid #dccfff;border-radius:6px;padding:2px 6px;margin:2px;display:inline-block;font-size:12px}
  .price-line{display:flex;gap:10px;flex-wrap:wrap;margin-top:8px}
  .tag{background:#f4f0ff;border:1px solid #dccfff;border-radius:6px;padding:2px 8px;font-size:12px}

  .footer{background:#1f1640;color:#fff}
  .footer-inner{max-width:1200px;margin:0 auto;padding:22px 16px;display:flex;flex-wrap:wrap;gap:22px;justify-content:space-between}
  .footer h4{margin:0 0 8px}
  .footer a{color:#fff;text-decoration:none}
  .fine{color:#c9c4e6;font-size:13px}
</style>
</head>
<body>

<!-- HERO -->
<section class="hero">
  <div class="wrap">
    <h1>Marleen Molenaar Collection</h1>
    <p>Premium Children‚Äôs & Ladies‚Äô Sleepwear ‚Äî Wholesale Catalogue</p>
    <div class="pill" id="hero-pill">Loading totals‚Ä¶</div>
  </div>
</section>

<div class="wrap">

  <!-- SIZE BREAKDOWN -->
  <div class="panel" id="sizes-panel">
    <h3>üßµ Size Breakdown ‚Äî Pieces Available</h3>
    <div class="size-tiles" id="size-tiles"></div>
  </div>

  <!-- PROOF LINKS -->
  <div class="panel">
    <h3>üèÜ Verified Luxury Credentials & Proof Links</h3>
    <div class="proof">
      <div class="proof-card">
        <h4>Lane Crawford Luxury Retailer</h4>
        <a href="https://www.lanecrawford.com/brand/700351/marleen-molenaar-sleepwear/women" target="_blank" rel="noopener">View Brand Page</a>
        <p>Hong Kong‚Äôs premier luxury department store ‚Äî equivalent to Harrods. Establishes brand positioning.</p>
      </div>
      <div class="proof-card">
        <h4>Retail Pricing Evidence</h4>
        <a href="https://retykle.com/products/marleen-molenaar-pyjama-set-2-8y" target="_blank" rel="noopener">Retykle Pricing Proof</a>
        <p>Shows premium retail/resale pricing for individual pieces.</p>
      </div>
      <div class="proof-card">
        <h4>Media Coverage</h4>
        <a href="https://www.scmp.com/article/533820/eastern-premise" target="_blank" rel="noopener">South China Morning Post</a>
        <p>2006 profile: ‚Äúrunning a children‚Äôs clothing design company under her own name.‚Äù</p>
      </div>
    </div>
  </div>

  <!-- FILTERS -->
  <div class="filters">
    <div class="row">
      <select id="catSel"><option value="">All Categories</option></select>
      <input id="q" placeholder="Search name, colour, description‚Ä¶" />
    </div>
    <div class="meta">
      <div>Showing <b id="visible-count">0</b> items</div>
      <div class="muted" id="totals-line">Totals update from CSV</div>
    </div>
  </div>

  <!-- PRODUCT GRID -->
  <div class="grid" id="grid"></div>
</div>

<!-- FOOTER -->
<footer class="footer">
  <div class="footer-inner">
    <div>
      <h4>Contact</h4>
      <p><strong>Gary Flax:</strong> <a href="tel:+61414242142">+61 414 242 142</a></p>
      <p><strong>Location:</strong> Vaucluse, Sydney NSW</p>
      <p><strong>Viewing:</strong> Weekdays 5pm+, Weekends anytime</p>
      <p class="fine">All items brand new with original tags. Driveway access for easy pickup.</p>
    </div>
    <div>
      <h4>Collection Summary</h4>
      <p id="summary-pieces" class="fine">‚Äî</p>
      <p class="fine">Organised in <strong>50 boxes</strong> for easy pickup</p>
      <p class="fine">Storage: Professional organization system</p>
      <p class="fine">Wholesale target: <strong>A$18,000‚Äì22,000</strong><br/>Quick sale target: <strong>A$12,000‚Äì15,000</strong></p>
    </div>
  </div>
</footer>

<script>
/* ---------- helpers ---------- */
const AUD = v => v===null||v===undefined||isNaN(v) ? '‚Äî' :
  'A$' + Number(v).toLocaleString('en-AU', {maximumFractionDigits: 0});

function parseCSV(text){
  const rows=[]; let row=[], cell='', q=false;
  for (let i=0;i<text.length;i++){
    const c=text[i], n=text[i+1];
    if (q){
      if (c=='"' && n=='"'){ cell+='"'; i++; }
      else if (c=='"'){ q=false; }
      else cell+=c;
    }else{
      if (c=='"'){ q=true; }
      else if (c==','){ row.push(cell); cell=''; }
      else if (c=='\n'){ row.push(cell); rows.push(row); row=[]; cell=''; }
      else if (c=='\r'){ }
      else cell+=c;
    }
  }
  if (cell.length || row.length) { row.push(cell); rows.push(row); }
  const headers = rows.shift().map(h=>h.trim());
  return rows.map(r=>{
    const o={};
    headers.forEach((h,i)=>o[h]=r[i]!==undefined ? r[i] : '');
    return o;
  });
}

function firstField(obj, names){
  for (const n of names){
    for (const k of Object.keys(obj)){
      if (k.trim().toLowerCase() === n.toLowerCase()) return obj[k];
    }
  }
  return null;
}

function num(x){ const v=parseFloat(String(x||'').replace(/[^\d.-]/g,'')); return isNaN(v)?0:v; }

function getSizeCount(obj, key){
  // Accept: "2" | "Size 2" | "size_2" | "S2"
  const keys = Object.keys(obj);
  const find = (k)=> keys.find(h=>{
    const lc = h.toLowerCase().replace(/\s+/g,'').replace('size','');
    return lc===String(k) || lc===('_'+k) || lc===('s'+k);
  });
  const h = find(key);
  return num(h ? obj[h] : 0);
}

function imageFor(sku){
  // Map SKU digits MM_0001 -> images/image1_small.jpg
  const m = String(sku||'').match(/(\d+)/);
  if (m){
    return `images/image${parseInt(m[1],10)}_small.jpg`;
  }
  return 'images/placeholder.webp';
}

/* ---------- main ---------- */
(async function(){
  const res = await fetch('detailed_inventory.csv',{cache:'no-store'});
  if (!res.ok){ document.getElementById('hero-pill').textContent='Data file not found'; return; }
  const text = await res.text();
  const rows = parseCSV(text);

  // normalize & compute
  const items = rows.map(r=>{
    const sku  = firstField(r,['SKU','sku']) || '';
    const name = firstField(r,['Item_Name','Item Name','New Product Names','Name']) || '';
    const brand= firstField(r,['Brand','brand']) || 'Marleen Molenaar';
    const desc = firstField(r,['Description','description']) || '';
    const colour = firstField(r,['Colour','Color','colour','color']) || '';
    const category = firstField(r,['Category','category']) || '';
    const qty = num(firstField(r,['Qty','Quantity','qty','quantity']));
    // RRP: prefer explicit RRP then Anchor Price
    const rrpExplicit = num(firstField(r,['RRP','rrp','Retail','Retail_Price']));
    const anchor = num(firstField(r,['Anchor Price','Anchor_Price']));
    const rrpVal = rrpExplicit || anchor || 0;

    // sizes from spreadsheet columns 2,4,6,8,10,12,14
    const sizes = {2:getSizeCount(r,2),4:getSizeCount(r,4),6:getSizeCount(r,6),8:getSizeCount(r,8),10:getSizeCount(r,10),12:getSizeCount(r,12),14:getSizeCount(r,14)};
    const sizeTotal = Object.values(sizes).reduce((a,b)=>a+b,0) || qty;

    const csvWholesale = num(firstField(r,['Wholesale','Wholesale Price','wholesale_price']));
    const csvQuick = num(firstField(r,['Discounted_Price','Quick','Quick Sale','quick_sale']));
    const derivedWholesale = rrpVal ? rrpVal*0.25 : 0;
    const derivedQuick     = rrpVal ? rrpVal*0.18 : 0;

    return {
      sku,name,brand,desc,colour,category,qty:sizeTotal, sizes, rrp: rrpVal || null,
      wholesale: csvWholesale || derivedWholesale || null,
      quick: csvQuick || derivedQuick || null,
      image:imageFor(sku)
    };
  });

  // totals
  const grandQty = items.reduce((a,b)=>a + (b.qty||0), 0);
  const sizeTotals = {2:0,4:0,6:0,8:0,10:0,12:0,14:0};
  items.forEach(it => { for (const k of Object.keys(sizeTotals)) sizeTotals[k]+= (it.sizes[k]||0); });

  // hero pill + summary
  document.getElementById('hero-pill').textContent = `${grandQty.toLocaleString()} pieces ‚Ä¢ ${items.length} SKUs ‚Ä¢ 50 boxes`;
  document.getElementById('summary-pieces').innerHTML = `<strong>${grandQty.toLocaleString()} pieces</strong> across <strong>${items.length}</strong> SKUs`;

  // size tiles
  const tiles = document.getElementById('size-tiles');
  tiles.innerHTML = '';
  [2,4,6,8,10,12,14].forEach(sz=>{
    const div=document.createElement('div');
    div.className='size-tile';
    div.innerHTML=`<b>Size ${sz}</b><span>${(sizeTotals[sz]||0).toLocaleString()} pieces</span>`;
    tiles.appendChild(div);
  });

  // category filter options
  const cats = [...new Set(items.map(i=>i.category).filter(Boolean))].sort();
  const catSel = document.getElementById('catSel');
  cats.forEach(c=>{ const o=document.createElement('option'); o.value=c; o.textContent=c; catSel.appendChild(o); });

  // render grid
  const grid = document.getElementById('grid');
  const q = document.getElementById('q');
  const vc = document.getElementById('visible-count');

  function match(it, needle){
    if (!needle) return true;
    const hay = `${it.name} ${it.desc} ${it.colour} ${it.category}`.toLowerCase();
    return hay.includes(needle.toLowerCase());
  }

  function render(){
    const needle = q.value.trim();
    const cat = catSel.value;
    const visible = items
      .filter(it => (!cat || it.category===cat) && match(it,needle))
      .sort((a,b) => { // with-photos first
        const aHas = !/placeholder/.test(a.image);
        const bHas = !/placeholder/.test(b.image);
        return (aHas===bHas) ? 0 : (aHas ? -1 : 1);
      });

    vc.textContent = visible.length;

    grid.innerHTML = visible.map(it=>{
      const sizeChips = Object.entries(it.sizes)
        .filter(([,n])=>n>0)
        .map(([sz,n])=>`<span class="chip">Size ${sz} ‚Ä¢ ${n}</span>`).join('') || '<span class="muted">Sizes: ‚Äî</span>';

      return `<div class="card">
        <div class="imgbox"><img loading="lazy" src="${it.image}" onerror="this.src='images/placeholder.webp'"></div>
        <div class="body">
          <div class="title">${it.name}</div>
          <div class="muted">${it.desc || '‚Äî'}</div>
          <div class="muted">Colour: ${it.colour || '‚Äî'}</div>
          <div class="sizes">${sizeChips}</div>
          <div class="price-line">
            <span class="tag">RRP: <strong>${AUD(it.rrp)}</strong></span>
            <span class="tag">Wholesale est.: <strong>${AUD(it.wholesale)}</strong></span>
            <span class="tag">Quick est.: <strong>${AUD(it.quick)}</strong></span>
          </div>
        </div>
      </div>`;
    }).join('');
  }

  q.addEventListener('input', render);
  catSel.addEventListener('change', render);
  render();
})();
</script>
</body>
</html>
