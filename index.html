<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Marleen Molenaar Collection ‚Äî Wholesale Catalogue</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#f5f6fb; --card:#ffffff; --muted:#717790; --ink:#1a1f36;
    --brand-1:#6b44ff; --brand-2:#9c6bff; --brand-3:#c1a6ff;
    --chip:#eef1ff; --chip-ink:#3b3ee6; --ok:#1a7f37; --warn:#b54708;
    --shadow: 0 6px 18px rgba(18,23,78,.12);
    --radius:16px;
  }
  *{box-sizing:border-box} body{margin:0;background:var(--bg);font:16px/1.45 "Inter",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial}
  .hero{background:linear-gradient(135deg,var(--brand-1),var(--brand-2));color:#fff;padding:56px 20px 28px}
  .wrap{max-width:1180px;margin:0 auto;padding:0 14px}
  h1{margin:0 0 14px;font-size:44px;line-height:1.05;font-weight:800}
  .meta{display:inline-block;margin-top:8px;background:rgba(255,255,255,.18);backdrop-filter:saturate(120%) blur(3px);border-radius:999px;padding:10px 16px;font-weight:600}
  .panel{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:18px;margin:14px 0}
  .grid-7{display:grid;grid-template-columns:repeat(7,minmax(0,1fr));gap:14px}
  .sizepill{background:#f3f2ff;border:1px solid #e4e1ff;border-radius:14px;padding:18px;text-align:center}
  .sizepill b{display:block;font-size:18px}
  .proof{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:14px}
  .proof .card{background:var(--card);border-radius:14px;padding:18px;border:1px solid #e9e9f7}
  .proof a{color:#3b3ee6;text-decoration:none;font-weight:600}
  .toolbar{display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin:6px 0 10px}
  select, input[type="search"]{background:#fff;border:1px solid #e3e5ef;border-radius:12px;padding:10px 12px;min-width:160px}
  .cards{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:16px}
  @media (max-width:980px){.cards{grid-template-columns:repeat(2,minmax(0,1fr))}}
  @media (max-width:680px){.cards{grid-template-columns:1fr}}
  .card{background:var(--card);border-radius:18px;box-shadow:var(--shadow);overflow:hidden;border:1px solid #eceffd}
  .card .img{display:block;background:#f6f7fb url('placeholder.webp') center/120px no-repeat;aspect-ratio:4/5}
  .card img{width:100%;height:100%;object-fit:contain;display:block}
  .card .body{padding:16px}
  .title{font-weight:700;font-size:20px;margin:0 0 6px}
  .muted{color:var(--muted)}
  .chips{display:flex;gap:8px;flex-wrap:wrap;margin:10px 0 8px}
  .chip{background:var(--chip);border:1px solid #dfe3ff;color:var(--chip-ink);border-radius:999px;padding:6px 10px;font-weight:600;font-size:13px}
  .tags{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
  .tag{background:#f7f8ff;border:1px dashed #e3e5ff;border-radius:10px;padding:8px 10px;font-weight:700;font-size:13px}
  .price{display:flex;gap:10px;flex-wrap:wrap;margin-top:8px}
  .price .rrp{background:#eef9f1;color:#0f5132;border:1px solid #cfead6}
  .price .wh{background:#fff8ef;color:#7a3e07;border:1px solid #f4dfc3}
  footer{background:#121528;color:#dfe2ff;margin-top:40px}
  footer .wrap{padding:28px 14px}
  footer b{color:#fff}
  .sr{position:absolute;left:-9999px}
</style>
</head>
<body>
  <header class="hero">
    <div class="wrap">
      <h1>Marleen Molenaar Collection</h1>
      <div id="heroMeta" class="meta">Loading totals‚Ä¶</div>
    </div>
  </header>

  <main class="wrap">

    <!-- SIZE BREAKDOWN -->
    <section class="panel">
      <h3 style="margin:0 0 6px;">üßµ Size Breakdown ‚Äî Pieces Available</h3>
      <div id="sizesRow" class="grid-7">
        <!-- Pills inserted by JS -->
      </div>
    </section>

    <!-- PROOF LINKS -->
    <section class="panel">
      <h3 style="margin:0 0 10px;">üèÜ Verified Luxury Credentials &amp; Proof Links</h3>
      <div class="proof">
        <div class="card">
          <h4 style="margin:0 0 6px;">Lane Crawford Luxury Retailer</h4>
          <a href="https://www.lanecrawford.com/brand/700351/marleen-molenaar-sleepwear/women" target="_blank" rel="noopener">View Brand Page</a>
          <p class="muted">Hong Kong‚Äôs premier luxury department store ‚Äî equivalent to Harrods. Establishes brand positioning.</p>
        </div>
        <div class="card">
          <h4 style="margin:0 0 6px;">Retail Pricing Evidence</h4>
          <a href="https://www.retykle.com/" target="_blank" rel="noopener">Retykle Pricing Proof</a>
          <p class="muted">Shows premium retail/resale pricing for individual pieces.</p>
        </div>
        <div class="card">
          <h4 style="margin:0 0 6px;">Media Coverage</h4>
          <a href="https://www.scmp.com/article/533820/eastern-premise" target="_blank" rel="noopener">South China Morning Post</a>
          <p class="muted">2006 profile: ‚Äúrunning a children‚Äôs clothing design company under her own name.‚Äù</p>
        </div>
      </div>
    </section>

    <!-- CONTROLS -->
    <section class="toolbar">
      <label class="sr" for="sizeFilter">Size</label>
      <select id="sizeFilter">
        <option value="">All Sizes</option>
        <option>2</option><option>4</option><option>6</option>
        <option>8</option><option>10</option><option>12</option><option>14</option>
      </select>

      <label class="sr" for="catFilter">Category</label>
      <select id="catFilter"><option value="">All Categories</option></select>

      <input id="searchBox" type="search" placeholder="Search name, colour, description" />
    </section>

    <!-- CARDS -->
    <section id="cards" class="cards" aria-live="polite"></section>
  </main>

  <footer>
    <div class="wrap" style="display:flex;gap:28px;justify-content:space-between;flex-wrap:wrap;">
      <div>
        <h3 style="margin:0 0 10px;">Contact Information</h3>
        <p><b>Gary Flax:</b> +61 414 242 142</p>
        <p><b>Location:</b> Vaucluse, Sydney NSW</p>
        <p><b>Viewing:</b> Weekdays 5pm+, Weekends anytime</p>
        <p><b>Access:</b> Ground floor, driveway access for easy pickup</p>
      </div>
      <div>
        <h3 style="margin:0 0 10px;">Collection Summary</h3>
        <p><b id="ftPieces">‚Äî</b> pieces across <b id="ftSkus">‚Äî</b> SKUs</p>
        <p>Organized in <b>50</b> boxes for easy pickup</p>
        <p>Storage: Professional organization system</p>
        <p><b>Wholesale:</b> <span id="ftWholesale">‚Äî</span> ‚Ä¢ <b>Quick sale:</b> <span id="ftQuick">‚Äî</span></p>
      </div>
    </div>
  </footer>

<script>
(async () => {
  // ---------- helpers ----------
  const $ = s => document.querySelector(s);
  const norm = s => (s||'').toString().toLowerCase().replace(/[^a-z0-9]+/g,'').trim();

  // Parse "2√ó4, 4√ó2, 8√ó6" ‚Üí {2:4, 4:2, 8:6}
  function parseSizeString(s){
    const out = {2:0,4:0,6:0,8:0,10:0,12:0,14:0};
    if(!s) return out;
    s.replace(/x/g,'√ó'); // normalise any ASCII x
    s.split(/\s*,\s*/).forEach(pair=>{
      const m = pair.match(/^\s*(2|4|6|8|10|12|14)\s*[√óx]\s*(\d+)\s*$/i);
      if(m){ out[m[1]] += Number(m[2]); }
    });
    return out;
  }

  // Fetch CSV ‚Üí array of objects
  async function csv(url){
    const res = await fetch(url+`?v=${Date.now()}`); // bust cache while iterating
    const text = await res.text();
    const rows = text.trim().split(/\r?\n/).map(r=>r.split(/,(?=(?:[^"]*"[^"]*")*[^"]*$)/));
    const header = rows.shift().map(h=>h.trim().toLowerCase());
    return rows.map(r=>{
      const obj = {};
      r.forEach((v,i)=> obj[header[i]] = v.replace(/^"|"$/g,''));
      return obj;
    });
  }

  // ---------- load data ----------
  const [items, imgMap] = await Promise.all([
    csv('detailed_inventory.csv'),
    csv('image_map.csv').catch(()=>[])
  ]);

  // Build image lookup by name
  const imgByName = {};
  imgMap.forEach(r=>{
    if(r.name && r.image) imgByName[norm(r.name)] = r.image;
  });

  // Precompute size counts + totals
  let totalPieces = 0;
  const topSizes = {2:0,4:0,6:0,8:0,10:0,12:0,14:0};
  const categories = new Set();

  // Clean + enrich records
  items.forEach(it=>{
    // expected columns: sku,brand,item_name,description,category,subcategory,size,colour,gender,condition,qty,rrp,wholesale_price,channel
    it.qty = Number(it.qty||0);
    it.rrp = Number(it.rrp||0);
    it.wholesale_price = Number(it.wholesale_price||0);
    const sizeStr = (it.size||'').trim();

    // a) row is a single-size row (size = 2/4/6/8/10/12/14)
    if (/^(2|4|6|8|10|12|14)$/i.test(sizeStr)) {
      topSizes[sizeStr] += it.qty;
      totalPieces += it.qty;
      it._sizes = {[sizeStr]: it.qty};
    }
    // b) row encodes multiple sizes, e.g. "2√ó4, 4√ó2..."
    else if (/[√óx]/.test(sizeStr)) {
      const map = parseSizeString(sizeStr);
      it._sizes = map;
      const sum = Object.values(map).reduce((a,b)=>a+b,0);
      totalPieces += sum;
      Object.keys(map).forEach(k=> topSizes[k] += map[k]);
    }
    // c) fallback ‚Äì treat qty but don‚Äôt contribute to size breakdown
    else{
      totalPieces += it.qty;
      it._sizes = {};
    }

    categories.add(it.category||'Uncategorised');

    // Image
    const key = norm(it.item_name || it.name);
    it._img = imgByName[key] || '';
  });

  // ---------- UI: hero + size pills ----------
  $('#heroMeta').textContent = `${totalPieces.toLocaleString()} pieces ‚Ä¢ ${new Set(items.map(i=>i.sku)).size} SKUs ‚Ä¢ 50 boxes`;
  $('#ftPieces').textContent = totalPieces.toLocaleString();
  $('#ftSkus').textContent = new Set(items.map(i=>i.sku)).size;
  // Estimate sums based on your current wholesale column
  const sumWholesale = items.reduce((a,b)=> a + (b.wholesale_price||0)*(Object.values(b._sizes).reduce((x,y)=>x+y,0) || b.qty||0), 0);
  const quickSale = 12000; // your stated quick sale goal
  $('#ftWholesale').textContent = sumWholesale.toLocaleString('en-AU',{style:'currency',currency:'AUD'});
  $('#ftQuick').textContent = quickSale.toLocaleString('en-AU',{style:'currency',currency:'AUD'});

  const sizeOrder = [2,4,6,8,10,12,14];
  const sizeRow = $('#sizesRow');
  sizeOrder.forEach(s=>{
    const n = topSizes[s]||0;
    const d = document.createElement('div');
    d.className='sizepill';
    d.innerHTML = `<b>Size ${s}</b>${n.toLocaleString()} pieces`;
    d.dataset.size = s;
    d.addEventListener('click',()=>{
      $('#sizeFilter').value = String(s);
      render();
      window.scrollTo({top: sizeRow.parentElement.offsetTop + sizeRow.parentElement.offsetHeight + 10, behavior:'smooth'});
    });
    sizeRow.appendChild(d);
  });

  // ---------- UI: category filter options ----------
  const catSel = $('#catFilter');
  [...categories].sort().forEach(c=>{
    const o = document.createElement('option');
    o.value = c; o.textContent = c; catSel.appendChild(o);
  });

  // ---------- render cards ----------
  const cards = $('#cards');
  function badgeSizes(map){
    const chips = [];
    sizeOrder.forEach(s=>{
      const q = map[s]||0;
      if(q>0) chips.push(`<span class="chip">${s}√ó${q}</span>`);
    });
    return chips.join('') || `<span class="chip">No size data</span>`;
  }
  function cardHtml(it){
    const qty = Object.values(it._sizes).reduce((a,b)=>a+b,0) || it.qty || 0;
    const rrp = it.rrp ? it.rrp : null;
    const wh  = it.wholesale_price ? it.wholesale_price : null;
    const img = it._img ? it._img : 'placeholder.webp';
    const imgTag = `<div class="img">${img==='placeholder.webp' ? '' : `<img src="${img}" alt="">`}</div>`;
    return `
    <article class="card">
      ${imgTag}
      <div class="body">
        <h3 class="title">${it.item_name || it.name || 'Unnamed'}</h3>
        <div class="muted">${it.description || ''} ${it.colour ? ` ‚Ä¢ Colour: ${it.colour}`:''}</div>
        <div class="chips">${badgeSizes(it._sizes)}</div>
        <div class="tags">
          <span class="tag">Qty: ${qty}</span>
          ${rrp ? `<span class="tag price rrp">RRP: ${Number(rrp).toLocaleString('en-AU',{style:'currency',currency:'AUD'})}</span>`:''}
          ${wh  ? `<span class="tag price wh">Wholesale: ${Number(wh).toLocaleString('en-AU',{style:'currency',currency:'AUD'})}</span>`:''}
        </div>
      </div>
    </article>`;
  }

  function render(){
    const sizeF = $('#sizeFilter').value.trim();
    const catF  = $('#catFilter').value.trim();
    const q     = $('#searchBox').value.trim().toLowerCase();

    const filtered = items.filter(it=>{
      // size filter: include card if it has >0 pieces for that size
      if(sizeF){
        const n = (it._sizes && it._sizes[sizeF]) || 0;
        if(n<=0) return false;
      }
      if(catF && (it.category||'') !== catF) return false;
      if(q){
        const hay = [
          it.item_name, it.name, it.description, it.colour, it.category, it.subcategory
        ].join(' ').toLowerCase();
        if(!hay.includes(q)) return false;
      }
      return true;
    });

    // sort: show cards with images first
    filtered.sort((a,b)=> (b._img?1:0) - (a._img?1:0));

    cards.innerHTML = filtered.map(cardHtml).join('');
  }

  $('#sizeFilter').addEventListener('change', render);
  $('#catFilter').addEventListener('change', render);
  $('#searchBox').addEventListener('input', render);

  render();
})();
</script>
</body>
</html>
