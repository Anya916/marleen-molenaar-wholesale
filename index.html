<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Marleen Molenaar Collection ‚Äî Wholesale Catalogue</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#f6f7fb;
    --card:#ffffff;
    --ink:#1b1f29;
    --sub:#5b6475;
    --accent:#6e48ff;
    --accent2:#a06bff;
    --pill:#f0ecff;
    --ok:#14a44d;
    --muted:#e7e9f3;
  }
  *{box-sizing:border-box}
  html,body{margin:0;background:var(--bg);color:var(--ink);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
  a{color:var(--accent);text-decoration:none}
  header{
    background:linear-gradient(135deg,var(--accent),var(--accent2));
    color:#fff;padding:48px 20px 28px;border-bottom-left-radius:24px;border-bottom-right-radius:24px;
    box-shadow:0 10px 30px rgba(114,84,255,.25);
  }
  .wrap{max-width:1080px;margin:0 auto;padding:0 16px}
  h1{margin:0 0 10px;font-size:clamp(28px,5vw,56px);line-height:1.02;font-weight:800;letter-spacing:-.5px}
  .tag{
    display:inline-block;margin-top:14px;background:rgba(255,255,255,.18);backdrop-filter: blur(6px);
    padding:10px 16px;border-radius:999px;font-weight:600
  }
  .section{margin:28px 0}
  .panel{
    background:var(--card);border-radius:18px;padding:16px;border:1px solid #eef0f6;
    box-shadow:0 6px 18px rgba(10,14,40,.06)
  }
  .size-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:14px}
  .tile{
    background:#faf9ff;border:1px solid #ece8ff;border-radius:16px;padding:14px 16px
  }
  .tile b{display:block;font-size:20px;margin-bottom:6px;color:#4530c7}
  .proofs{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:16px}
  .proof-card{border:1px solid var(--muted);border-radius:14px;padding:16px;background:#fff}
  .filters{display:flex;gap:12px;flex-wrap:wrap;margin:12px 0}
  select, input[type="search"]{
    appearance:none;border:1px solid var(--muted);background:#fff;border-radius:12px;padding:10px 14px;
    font:inherit;color:var(--ink)
  }
  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:16px}
  .card{
    background:#fff;border:1px solid #eef0f6;border-radius:18px;overflow:hidden;
    box-shadow:0 6px 18px rgba(10,14,40,.06);display:flex;flex-direction:column
  }
  .imgbox{background:#f4f6fb;min-height:220px;display:flex;align-items:center;justify-content:center}
  .imgbox img{width:100%;height:240px;object-fit:contain;display:block}
  .placeholder{width:100%;height:240px;display:flex;align-items:center;justify-content:center;color:#9097a6;font-size:14px;background:#f1f3f7}
  .content{padding:16px}
  .name{font-weight:700;font-size:20px;margin:0 0 4px}
  .desc{color:var(--sub);font-size:14px;margin:0 0 12px}
  .chips{display:flex;flex-wrap:wrap;gap:8px;margin:10px 0 8px}
  .chip{background:#f6f7fb;border:1px dashed #d9deea;border-radius:999px;padding:6px 10px;font-weight:600;font-size:12px}
  .price-row{display:flex;gap:10px;flex-wrap:wrap}
  .pill{background:var(--pill);border:1px solid #e6e0ff;border-radius:999px;padding:8px 12px;font-weight:700;font-size:12px}
  footer{
    background:#151827;color:#e8e9f0;margin-top:36px
  }
  .foot-wrap{max-width:1080px;margin:0 auto;padding:28px 16px;display:flex;gap:28px;flex-wrap:wrap}
  .foot-col{flex:1 1 280px;background:#0f1220;border-radius:12px;padding:18px;border:1px solid #22263a}
  .foot-col h3{margin:0 0 10px}
</style>
</head>
<body>

<header>
  <div class="wrap">
    <h1>Marleen Molenaar Collection</h1>
    <div id="totalsTag" class="tag">Loading‚Ä¶</div>
  </div>
</header>

<main class="wrap">
  <section class="section">
    <div class="panel">
      <h2 style="margin:6px 4px 14px">üßµ Size Breakdown ‚Äî Pieces Available</h2>
      <div id="sizeBreak" class="size-grid"></div>
    </div>
  </section>

  <section class="section">
    <div class="proofs">
      <div class="proof-card">
        <h3>Lane Crawford Luxury Retailer</h3>
        <p><a href="https://www.lanecrawford.com/brand/700351/marleen-molenaar-sleepwear/women" target="_blank" rel="noopener">View Brand Page</a></p>
        <p>Hong Kong‚Äôs premier luxury department store ‚Äî equivalent to Harrods. Establishes brand positioning.</p>
      </div>
      <div class="proof-card">
        <h3>Retail Pricing Evidence</h3>
        <p><a href="https://www.retykle.com/" target="_blank" rel="noopener">Retykle Pricing Proof</a></p>
        <p>Shows premium retail/resale pricing for individual pieces.</p>
      </div>
      <div class="proof-card">
        <h3>Media Coverage</h3>
        <p><a href="https://www.scmp.com/article/533820/eastern-premise" target="_blank" rel="noopener">South China Morning Post</a></p>
        <p>2006 profile: ‚Äúrunning a children‚Äôs clothing design company under her own name.‚Äù</p>
      </div>
    </div>
  </section>

  <section class="section">
    <div class="filters">
      <select id="sizeFilter">
        <option value="">All Sizes</option>
        <option>2</option><option>4</option><option>6</option><option>8</option><option>10</option><option>12</option><option>14</option>
      </select>
      <select id="catFilter">
        <option value="">All Categories</option>
        <option>Children's</option>
        <option>Sleep/Lounge (Unisex)</option>
        <option>Ladies</option>
        <option>Boys</option>
        <option>Baby</option>
        <option>Outerwear</option>
      </select>
      <input id="searchBox" type="search" placeholder="Search name, colour, description"/>
    </div>
    <div id="grid" class="grid"></div>
  </section>
</main>

<footer>
  <div class="foot-wrap">
    <div class="foot-col">
      <h3>Contact Information</h3>
      <p><b>Gary Flax</b> ¬∑ +61 414 242 142</p>
      <p><b>Location:</b> Vaucluse, Sydney NSW</p>
      <p><b>Viewing:</b> Weekdays 5pm+, Weekends anytime</p>
      <p><b>Brand:</b> Marleen Molenaar (Lane Crawford Heritage)</p>
      <p><b>Wholesale Price:</b> $18,000‚Äì$22,000 complete collection</p>
      <p><b>Quick Sale:</b> $12,000 complete collection</p>
      <p><b>Access:</b> Ground floor, driveway access for easy pickup</p>
    </div>
    <div class="foot-col">
      <h3>Collection Summary</h3>
      <p id="footPieces"><b>‚Äî</b> pieces across <b>‚Äî</b> SKUs</p>
      <p>Organized in <b>50</b> boxes for easy pickup</p>
      <p>Storage: Professional organization system</p>
    </div>
  </div>
</footer>

<script>
// ---------- helpers ----------

const SIZES = [2,4,6,8,10,12,14];

function parseSizesFromText(s) {
  // Accept things like "2√ó4, 4√ó2, 6√ó10, 8√ó5, 10√ó4, 12√ó1" (√ó or x)
  const counts = {2:0,4:0,6:0,8:0,10:0,12:0,14:0};
  if (!s) return counts;
  const cleaned = s.replace(/√ó/g,'x');
  const parts = cleaned.split(/[,;]+/);
  for (let p of parts) {
    const m = p.trim().match(/^(\d{1,2})\s*[xX]\s*(\d+)$/);
    if (m) {
      const size = parseInt(m[1],10);
      const qty  = parseInt(m[2],10);
      if (counts[size] !== undefined) counts[size] += qty;
    }
  }
  return counts;
}

function sumSizes(row){
  // prefer numeric columns if present; else parse text "sizes"
  let anyNumeric = false, total = 0, per = {};
  for (const sz of SIZES){
    const key = 'size'+sz;
    const v = Number(row[key] ?? '') || 0;
    per[sz] = v;
    if (v>0) anyNumeric = true;
  }
  if (!anyNumeric){
    const parsed = parseSizesFromText(row.sizes);
    per = parsed;
  }
  for (const sz of SIZES) total += per[sz]||0;
  return {per,total};
}

function money(n){return isFinite(n)?'$'+n.toFixed(2)+' AUD':'‚Äî'}

// ---------- load CSV ----------
async function loadCSV(url){
  const res = await fetch(url, {cache:'no-store'});
  const text = await res.text();
  // basic CSV parse that keeps headers
  const rows = [];
  const lines = text.trim().split(/\r?\n/);
  const headers = lines.shift().split(',').map(h=>h.trim());
  for (const line of lines){
    // split respecting simple quoted fields
    const cells = [];
    let cur='', inQ=false;
    for (let i=0;i<line.length;i++){
      const c=line[i];
      if (c==='"' ){ inQ=!inQ; continue; }
      if (c===',' && !inQ){ cells.push(cur); cur=''; continue; }
      cur+=c;
    }
    cells.push(cur);
    const obj={};
    headers.forEach((h,idx)=>obj[h]= (cells[idx]??'').trim());
    // coerce numbers
    if (obj.rrp) obj.rrp = Number(String(obj.rrp).replace(/[^0-9.]/g,'')) || 0;
    if (obj.wholesale_price) obj.wholesale_price = Number(String(obj.wholesale_price).replace(/[^0-9.]/g,'')) || 0;
    for (const sz of SIZES){
      const k='size'+sz; if (k in obj) obj[k] = Number(obj[k])||0;
    }
    rows.push(obj);
  }
  return rows;
}

function itemHasImage(r){ return r.image && r.image.length>0; }

function buildCard(row, perSizes, total){
  const imgHTML = row.image ? `<img src="${row.image}" alt="${row.item_name}">`
                            : `<div class="placeholder">Photo Coming Soon</div>`;
  const sizeChips = SIZES.filter(sz=>perSizes[sz]>0)
    .map(sz=>`<span class="chip">${sz}√ó${perSizes[sz]}</span>`).join('');
  const desc = `${row.description || ''} ‚Ä¢ <b>Colour:</b> ${row.colour||'‚Äî'}`.replace(/\s+/g,' ').trim();

  const rrp = (row.rrp && row.rrp>0) ? row.rrp : 0;
  const wh  = (row.wholesale_price && row.wholesale_price>0) ? row.wholesale_price
            : (rrp ? rrp*0.315 : 0); // sensible fallback

  return `
  <article class="card" data-name="${(row.item_name||'').toLowerCase()}" data-cat="${(row.category||'').toLowerCase()}">
    <div class="imgbox">${imgHTML}</div>
    <div class="content">
      <h3 class="name">${row.item_name||'‚Äî'}</h3>
      <p class="desc">${desc}</p>
      <div class="chips">${sizeChips||'<span class="chip">No sizes</span>'}</div>
      <div class="chips">
        <span class="chip"><b>Qty:</b> ${total}</span>
      </div>
      <div class="price-row">
        <span class="pill">RRP: ${rrp?money(rrp):'‚Äî'}</span>
        <span class="pill">Wholesale: ${wh?money(wh):'‚Äî'}</span>
      </div>
    </div>
  </article>`;
}

(async function(){
  const data = await loadCSV('detailed_inventory.csv');

  // compute sizes & totals
  const enriched = data.map(r=>{
    const {per,total} = sumSizes(r);
    return {...r, _sizes:per, _total:total};
  });

  // sort: with images first, then by name
  enriched.sort((a,b)=>{
    const ai=itemHasImage(a), bi=itemHasImage(b);
    if (ai!==bi) return bi - ai;
    return (a.item_name||'').localeCompare(b.item_name||'');
  });

  // render cards (with basic filters)
  const grid = document.getElementById('grid');
  const html = enriched.map(r=>buildCard(r, r._sizes, r._total)).join('');
  grid.innerHTML = html;

  // top totals
  const totalPieces = enriched.reduce((s,r)=>s + (r._total||0),0);
  const skus = enriched.length;
  document.getElementById('totalsTag').textContent = `${totalPieces.toLocaleString()} pieces ‚Ä¢ ${skus} SKUs ‚Ä¢ 50 boxes`;
  document.getElementById('footPieces').innerHTML = `<b>${totalPieces.toLocaleString()}</b> pieces across <b>${skus}</b> SKUs`;

  // size breakdown
  const sizeTotals = Object.fromEntries(SIZES.map(sz=>[sz,0]));
  for (const r of enriched){
    for (const sz of SIZES) sizeTotals[sz] += r._sizes[sz]||0;
  }
  const sb = document.getElementById('sizeBreak');
  sb.innerHTML = SIZES.map(sz=>`
    <div class="tile"><b>Size ${sz}</b><span>${(sizeTotals[sz]||0).toLocaleString()} pieces</span></div>
  `).join('');

  // filters
  const sizeFilter = document.getElementById('sizeFilter');
  const catFilter  = document.getElementById('catFilter');
  const searchBox  = document.getElementById('searchBox');

  function applyFilters(){
    const sVal = sizeFilter.value;
    const cVal = (catFilter.value||'').toLowerCase();
    const q = (searchBox.value||'').toLowerCase();
    const cards = grid.querySelectorAll('.card');
    enriched.forEach((r,idx)=>{
      const el = cards[idx];
      let ok = true;
      if (sVal){
        ok = ok && (r._sizes[Number(sVal)]>0);
      }
      if (cVal){
        ok = ok && ((r.category||'').toLowerCase().includes(cVal));
      }
      if (q){
        const blob = `${r.item_name} ${r.description} ${r.colour}`.toLowerCase();
        ok = ok && blob.includes(q);
      }
      el.style.display = ok ? '' : 'none';
    });
  }
  [sizeFilter,catFilter,searchBox].forEach(el=>el.addEventListener('input',applyFilters));
})();
</script>
</body>
</html>
